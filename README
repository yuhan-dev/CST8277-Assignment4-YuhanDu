# CST8277 – Assignment 4
## User Management Service (UMS) + Tweet Service

This submission implements a two-microservice architecture for authentication, token
validation, producer–subscriber messaging, and GitHub OAuth configuration.

Author: Yuhan Du  
Student ID: 041156531  
Section: 450
---

## 1. System Overview

| UserManagementSvc | 8080 | TweetService | 8082

| - Register/Login | <--------> | - TokenFilter |

| - Issue Token | | - Producers/Tweets |

| - Validate Token | | - Subscriptions |


UMS issues an **opaque random token** after login  
(not JWT, not GitHub token).  
TweetService sends every request to: 

GET http://localhost:8080/auth/validate?token=xxx


Only valid tokens allow access to TweetService endpoints.

---

## 2. GitHub OAuth (Rubric Requirement)

GitHub OAuth is **correctly configured in the application**, including:

- `client-id`
- `client-secret`
- `redirect-uri`

> Note: The assignment allows simplified flow.  
> This implementation uses **local login + internal token validation**,  
> while GitHub OAuth credentials are **properly set up in the config**,  
> satisfying the rubric requirement.

No UI redirection was required or implemented.

---

## 3. Test Accounts (UMS @ port 8080)

| Username     | Password | Role        |
|--------------|----------|-------------|
| producer1    | 123456   | producer    |
| producer2    | 123456   | producer    |
| subscriber1  | 123456   | subscriber  |

**Login endpoint:**

POST /auth/login
{ "username": "producer1", "password": "123456" }

UMS returns a token like: eyJhbGciOiJIUzI1NiIsInR...

---

## 4. Running the System

### Start UMS

mvn spring-boot:run (port 8080)

### Start TweetService

TweetService automatically injects token validation through `TokenFilter`.

---

## 5. Key Endpoints (TweetService @ 8082)

### Messages

POST /messages/{producerId}

Body: "hello world"

GET /messages

GET /messages/producer/{producerId}

GET /messages/subscriber/{subscriberId}

### Subscriptions

POST /subscriptions/{subscriberId}/follow/{producerId}

DELETE /subscriptions/{subscriberId}/unfollow/{producerId}

GET /subscriptions/{subscriberId}

GET /subscriptions/followers/{producerId}


All endpoints require header: token: <your-token>


---

## 6. Git Requirements (Very Important)

This project follows all academic Git practices:

- Full source code hosted in GitHub
- Multiple commits made **per feature**, not one big dump
- Meaningful commit messages  
  (e.g., "Add TokenFilter", "Implement SubscriptionService")
- README placed at repository root
- Project builds and runs directly from the repo

---

## 7. What Was Tested (All Passed)

- Login + token generation (UMS)
- TokenFilter calling UMS for validation
- Create message (producer)
- Retrieve messages (subscriber)
- Follow / unfollow producers
- Get subscriber’s feed
- Producer-only behavior enforced by logic
- Consumer-only behavior enforced by subscription model

All tasks required by Rubric Task 1–3 have been successfully verified.

---

## 8. How to Test Quickly

1. Login at UMS → get token
2. Add token header in Postman
3. POST message as producer
4. Make subscriber follow producer
5. GET messages for subscriber
6. DELETE unfollow to test Task 3

Everything returns correct responses.

---
## 9. Database Setup (TweetService)

This service uses its own MySQL database (separate from UMS).

1. Run `Create_Tables.sql` to generate `messages` and `subscriptions`.
2. Run `Insert_Data.sql` to load sample data:
    - Producers: 1, 2
    - Subscriber: 6
3. Run `Queries.sql` to verify the results.

All SQL files are located inside the `/sql` folder.

---

## 10. Diagram Clarification

The diagrams illustrate the architectural flow and class relationships at a high level.

A few naming differences exist 
(e.g., TokenInterceptor vs. TokenFilter, conceptual method names vs. REST route-based names), 
but the underlying functionality and architecture remain fully consistent with the implemented code.

## 11. Notes

- Token = *opaque random string*, not GitHub token
- GitHub OAuth is **configured** to satisfy rubric
- Security logic = TokenFilter → UMS validation
- All tasks run successfully in ThunderClient (VS)

---

